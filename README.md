# 简答题

## 一、请说出系列最终的执行结果, 并解释为什么
```javascript
var a = [];
for (var i = 0; i < 10; i++) {
  a[i] = function () {
    console.log(i);
  };
}
a[6]();
```

### Answer 1
* 执行结果为 `10`
* 因为数组 `a[6]` 为一个函数, 使用了外部变量 `i`, `i` 来自全局作用域链, 在执行 `a[6]` 时, 函数查找其父作用域链, 执行到`a[6]()` 时, `i` 循环到 `10` 的时候, `for` 循环体结束, `i` 一直在内存中, 数组里所有的函数都指向同一个 `i`, 所以 `a[6]()` 执行时引用到的值为 `10`

<br/>
<br/>

## 二、请说出下列最终的执行结果, 并解释为什么
```javascript
var tmp = 123;

if (true) {
  console.log(tmp);
  let tmp;
}
```

### Answer 2
* 执行结果返回 ReferenceError
* 在 `if` 代码块内, 使用了 `let` 声明了变量 `tmp`, 使得在当前块作用域内 `tmp` 被绑定到局部变量 `tmp`, 会屏蔽掉外部 `tmp`; 而又如果在块作用域内， 且 `let` 声明前就使用该变量, 就会报引用错误, 导致这种现象的原因一般称为暂时性死区;

<br />
<br />

## 三、结合 ES6 新语法, 用最简单的方式找出数组中的最小值
```javascript
var arr = [12, 34, 32, 89, 4]
```

### Answer 3
```javascript
var arr = [12, 34, 32, 89, 4];

const min_value = Math.min(...arr);
console.log(min_value);
```

## 四、请详细说明 var, let, const 三种声明变量的方式之间的具体差别

### Answer 4
* `var`
    * 声明的变量会使变量声明提前;
    * 没有块级作用域, 只有全局和函数作用域
    * 可以重复声明
* `let`
    * 没有声明提前, 使用未声明的变量时, 会报错
    * 产生块级作用域
    * 在同一块作用域内不可重复声明同名变量
* `const`
    * 同 `let`
    * 在声明时必须赋值, 声明后不可再修改其值

<br />
<br />

## 五、请说出下列代码最终输出的结果, 并解释为什么
```javascript
var a = 10;

var obj = {
  a: 20,
  fn() {
    setTimeout(() => {
      console.log(this.a);
    });
  },
};
obj.fn();
```

### Answer 5
* 执行结果为 `20`
* `setTimeout` 里的回调函数里的 `this` 指向的是 `obj` 这个对象, 所以`this.a` 为 `obj` 对象的 `a`; 函数内的 `this` 指向只在执行时才能确定, 由于箭头函数没有 `this`, 所以匿名箭头回调函数里的 `this` 来自外部的 `fn` 函数, 而 `fn` 里的 `this` 指向的是 `obj`, 所以返回的是 `obj` 对象的 `a`, 即 `20`

## 六、简述 Symbol 类型的用途
### Answer 6
* Symbol 类型用来表示一个全局唯一的值, 这个值不会重复, 用来表示唯一的属性名;
* 扩展已有模块的属性, 比如为某个对象新增属性, 这个属性将不会与已有的属性冲突;
* 模拟私有成员, 外部引用不到这个 Symbol, 就使这个 属性 变成了外部不能访问的私有成员;
* 可以为自定义对象添加内置功能, 通过内部 Symbol 值来添加函数的实现, 比如`Symbol.iterator` 等

## 七、说说什么是浅拷贝, 什么是深拷贝?
### Answer 7
* 浅拷贝
  * 即完整复制变量时, 基本数据类型直接拷贝值, 而引用类型的值拷贝地址, 因此拷贝后的值里, 引用对象指向的是同一内存空间, 两者中的其一改动引用类型内部的值时,通过另一对象访问时将得到改动后的值;
* 深拷贝
  * 即完整复制变量时, 基本数据类型直接拷贝值，引用类型的值将通过新建内存空间, 复制一份全新的引用类型值, 两者之间是相互独立的;

  ## 八、请简述 Typescript 与 Javscript 之间的关系
  ### Answer
  * `typescript` 是对 `javascript` 的扩展集, 为 `javascript` 扩展了 **类型系统**, **对 ES6+ 的转编译**

## 九、请谈谈你所认为的 TypeScript 优缺点
### Answer 9
* 优点
  * 渐进式, 可直接使用 `javascript`, 便于语言的学习与过度
  * 类型系统, 增加了 `javascript` 代码的健壮性, 减少代码错误
  * 转编译, 可以使用新特性, 兼容老代码
  * 生态健全, 完善
* 缺点
  * 学习新概念
  * 初始开发成本增加

## 十、描述引用计数的工作原理和优缺点
### Answer 10
* 原理
  * 对变量的引用次数进行记录, 再代码执行过程中, 将引用次数为0 的变量进行垃圾回收
* 优点
   * 立即回收
   * 减少程序垃圾回收的停顿
* 缺点
    * 不能回收循环引用
    * 回收时间长

## 十一、描述标记整理算法的工作流程
### Answer 11
* 标记阶段, 遍历所有对象, 标记所有活动对象
* 清除阶段, 遍历所有对象, 将活动对象与未标记对象的空间整理成连续空间,然后回收未活动对象, 最后清除所有活动标记

## 十二、描述 V8 中新生代存储区垃圾回收的流程
### Answer 12
* 新生代存储区分成 2 个等大的内存, From 区 和 To 区
* 先存储活动时间比较短的对象到新生代存储区的 From 区
* 通过标记整理将活动对象拷贝至 To 区
* 拷贝过程中有晋升则将其拷贝至老生代
* gc 回收 From 区的对象, 然后 From 与 To 交换空间

## 十三、描述增量标记算法在何时使用及工作原理
### Answer 13
* 在V8引擎内部, 程序执行时, 一边执行代码, 一边穿插着分步执行内部的回收算法,标记的步骤与代码执行交替运行, 通过增量的方式去标记活动对象, 标记完后执行清除回收; 这样一来使代码执行不会长时间卡死;